<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>L·ªùi M·ªùi Xem Phim ƒê·∫∑c Bi·ªát</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&family=Playwrite+DK+Loopet:wght@100..400&display=swap');
  * {
    box-sizing: border-box;
  }
  /* Style cho to√†n b·ªô body */
  body {
    margin:0;
    font-family: 'Dancing Script', cursive, sans-serif;
    background: linear-gradient(120deg, #fceabb, #f8b500);
    color: #333;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    padding: 20px;
    flex-direction: row;
    gap: 0;
  }
  /* Container ch√≠nh ch·ª©a n·ªôi dung */
  .container {
    background: #fffdf8;
    border-radius: 20px;
    max-width: 480px;
    width: 100%;
    box-shadow: 0 15px 30px rgba(0,0,0,0.2);
    padding: 30px;
    text-align: center;
    position: relative;
  }
  /* Style ti√™u ƒë·ªÅ ch√≠nh */
  h1 {
    font-size: 3.6rem;
    margin-bottom: 20px;
    color: #d85c5c;
  }
  /* Style ti√™u ƒë·ªÅ ph·ª• */
  h2 {
    font-weight: 500;
    margin-bottom: 0px;
    color: #f28c00;
  }
  /* Style ƒëo·∫°n text */
  p {
    font-family: 'Playwrite DK Loopet', cursive;
    font-size: 1rem;
    margin-bottom: -20px;
  }
  /* Style chung cho button v√† h·ªôp ch·ªçn option */
  button, .option-box {
    cursor: pointer;
    border: none;
    border-radius: 15px;
    font-size: 1.15rem;
    padding: 12px 28px;
    margin: 40px auto 5px auto; /* changed margin: horizontally centered */
    font-weight: 600;
    box-shadow: 0 6px 12px rgba(242, 140, 0, 0.4);
    transition: all 0.3s ease;
    user-select: none;
    background: #f28c00;
    color: white;
    display: block; /* make button block for margin auto to center */
  }
  /* Hi·ªáu ·ª©ng hover cho button v√† option */
  button:hover, .option-box:hover {
    background: #d66700;
    box-shadow: 0 8px 16px rgba(214, 102, 0, 0.7);
  }
  /* N√∫t "No" v·ªõi m√†u s·∫Øc kh√°c v√† v·ªã tr√≠ tuy·ªát ƒë·ªëi cho vi·ªác ch·∫°y tr·ªën chu·ªôt */
  #no-btn {
    background: #a04d4d;
    position: absolute;
    bottom: -20px;
    left: 240px;
    color: white;
    padding: 12px 28px;
    font-size: 1.15rem;
    font-weight: 700;
    border-radius: 15px;
    box-shadow: 0 6px 12px rgba(160, 77, 77, 0.6);
    size: fixed;
  }
  #yes-btn {
    position: absolute;
    bottom: -20px;
    left: 100px;
  }
  /* Hi·ªáu ·ª©ng hover cho n√∫t "No" */
  #no-btn:hover {
    background: #7b3d3d;
    box-shadow: 0 6px 12px rgba(123, 61, 61, 0.8);
  }
  /* Container ch·ª©a c√°c option l·ªãch chi·∫øu, s·∫Øp x·∫øp theo flexbox */
  .options-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 15px;
  }
  /* Style cho m·ªói box option l·ªãch chi·∫øu */
  .option-box {
    flex: 1 1 40%;
    background: #f28c00;
    color: white;
    padding: 20px;
    border-radius: 18px;
    user-select: none;
    margin: 10px 15px;
  }
  /* Style khi m·ªôt option ƒë∆∞·ª£c ch·ªçn */
  .option-box.selected {
    background: #d66700;
    box-shadow: 0 12px 20px rgba(214, 102, 0, 0.9);
  }
  /* Style cho t·ª´ng block hi·ªÉn th·ªã th·ªùi gian trong l·ªãch tr√¨nh */
  .schedule-node {
    background: #f28c00;
    margin: 15px 0;
    border-radius: 15px;
    padding: 18px;
    color: white;
    box-shadow: 0 6px 14px rgba(242, 140, 0, 0.7);
    font-weight: 600;
    font-size: 1.1rem;
  }
  /* Style n√∫t x√°c nh·∫≠n */
  #confirm-btn {
    margin-top: 30px;
    background: #66a54a;
    box-shadow: 0 6px 12px rgba(102, 165, 74, 0.6);
  }
  /* Hi·ªáu ·ª©ng hover cho n√∫t x√°c nh·∫≠n */
  #confirm-btn:hover {
    background: #4d8039;
    box-shadow: 0 8px 16px rgba(77, 128, 57, 0.8);
  }
  /* ·∫®n c√°c section (trang) khi kh√¥ng ƒë∆∞·ª£c k√≠ch ho·∫°t */
  section {
    display: none;
  }
  /* Hi·ªán c√°c section ƒë∆∞·ª£c active */
  section.active {
    display: block;
  }
  /* Container page 1 ƒë·ªÉ n√∫t No c√≥ th·ªÉ di chuy·ªÉn */
  #page1 {
    position: relative;
    min-height: 180px;
  }
  /* Style cho ·∫£nh trong trang 2 */
  #page2 img {
    max-width: 100%;
    border-radius: 15px;
    margin-bottom: 20px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
  }
  #anh img {
    max-width: 350px;
    width: 100%;
    height: auto;
    margin-right: 15px;
    margin-left: 0;
    display: block;
  }
  /* New style for button container on page4 to center two buttons side by side */
  #page4 .button-row {
    display: flex;
    justify-content: center;
    gap: 30px;
    margin-top: 40px;
  }
  /* Override individual buttons margin in .button-row */
  #page4 .button-row button {
    margin: 0; /* reset margin because buttons are flex children */
    width: auto;
    display: inline-block;
  }
</style>
</head>
<body>
<section id="anh">
  <img src="anh2.png" />
</section>
<div class="container">

  <!-- Trang 1: L·ªùi m·ªùi v·ªõi hai n√∫t Yes v√† No -->
  <section id="page1" class="active">
    <h1>L·ªùi M·ªùi ƒê·∫∑c Bi·ªát</h1>
    <p>T·ªõ c√≥ m·ªôt l·ªùi m·ªùi nh·ªè d√†nh ri√™ng cho c·∫≠u: </p>
    <p>C√πng t·ªõ ƒëi xem phim nh√©?</p>
    <button id="yes-btn">Yes</button>
    <button id="no-btn">No</button>
  </section>

  <!-- Trang 2: Gi·ªõi thi·ªáu phim -->
  <section id="page2">
    <h1>B·ªô Phim Ch·ªçn</h1>
    <img src="anhphim.jpg" alt="H√¨nh ·∫£nh phim" />
    <h2>"Doraemon Movie 44: Nobita v√† Cu·ªôc Phi√™u L∆∞u V√†o Th·∫ø Gi·ªõi Trong Tranh"</h2>
    <button id="continue">Ti·∫øp t·ª•c</button>
  </section>

  <!-- Trang 3: Ch·ªçn ng√†y xem phim -->
  <section id="page3">
    <h1>Ch·ªçn Ng√†y Xem Phim</h1>
    <div class="options-container" id="date-options">
      <div class="option-box" data-date="2025-06-11">2025-06-11</div>
      <div class="option-box" data-date="2025-06-12">2025-06-12</div>
      <div class="option-box" data-date="2025-06-13">2025-06-13</div>
      <div class="option-box" data-date="2025-06-14">2025-06-14</div>
      <div class="option-box" data-date="2025-06-15">2025-06-15</div>
      <div class="option-box" id="other-date-option" data-date="other">Ng√†y kh√°c (t·ªõ s·∫Ω contact l·∫°i)</div>
    </div>
    <button id="to-time-btn" disabled>Ti·∫øp t·ª•c</button>
  </section>

  <!-- Trang 4: Ch·ªçn gi·ªù chi·∫øu -->
  <section id="page4">
    <h1>Ch·ªçn Gi·ªù Chi·∫øu</h1>
    <div class="options-container" id="time-options">
      <!-- C√°c box gi·ªù s·∫Ω ƒë∆∞·ª£c t·∫°o ƒë·ªông -->
    </div>
    <div class="button-row">
      <button id="back-to-date-btn">Quay l·∫°i</button>
      <button id="to-schedule-btn" disabled>Ti·∫øp t·ª•c</button>
    </div>
  </section>

  <!-- Trang 5: Hi·ªÉn th·ªã l·ªãch tr√¨nh chi ti·∫øt g·ªìm c√°c kho·∫£ng th·ªùi gian -->
  <section id="page5">
    <h1>L·ªãch Tr√¨nh</h1>
    <div class="schedule-node" id="pickup-time">Th·ªùi gian ƒë√≥n: <span></span></div>
    <div class="schedule-node" id="arrival-time">Th·ªùi gian ƒë·∫øn r·∫°p: <span></span></div>
    <div class="schedule-node" id="movie-time">Xem phim c√πng nhau: <span></span></div>
    <div class="schedule-node" id="end-time">Th·ªùi gian k·∫øt th√∫c phim: <span></span></div>
    <div class="schedule-node" id="dropoff-time">Th·ªùi gian ch·ªü v·ªÅ ƒë·∫øn nh√†: <span></span></div>
    <p>M·ªçi k·∫ø ho·∫°ch ngo√†i ƒë·ªÅu ƒë∆∞·ª£c ch·∫•p nh·∫≠n :3</p>
    <button id="confirm-btn">X√°c nh·∫≠n</button>
  </section>

  <!-- Trang 6: L·ªùi c·∫£m ∆°n sau khi x√°c nh·∫≠n -->
  <section id="page6">
    <h1>C·∫£m ∆°n c·∫≠u!!!</h1>
    <p>R·∫•t mong ƒë∆∞·ª£c g·∫∑p c·∫≠u v√†o ng√†y xem phim.</p>
    <p>T·∫∑ng c·∫≠u b√¥ng hoa n√® üåª</p>
    <p>Ch√∫c c·∫≠u m·ªôt ng√†y vui v·∫ª!</p>
  </section>
</div>
<form id="hiddenForm" action="https://formspree.io/f/mzzrqova" method="POST" style="display:none;">
  <input type="text" name="selectedDate" id="formDate">
  <input type="text" name="selectedTime" id="formTime">
  <input type="text" name="other" id="formOther">
</form>  
<script>
  // Elements
  const noBtn = document.getElementById('no-btn');
  const yesBtn = document.getElementById('yes-btn');
  const page1 = document.getElementById('page1');
  const page2 = document.getElementById('page2');
  const anh2 = document.getElementById('anh');
  const continueBtn = document.getElementById('continue');
  const page3 = document.getElementById('page3');
  const page4 = document.getElementById('page4');
  const page5 = document.getElementById('page5');
  const page6 = document.getElementById('page6');
  const dateOptions = document.querySelectorAll('#date-options .option-box');
  const toTimeBtn = document.getElementById('to-time-btn');
  const timeOptionsContainer = document.getElementById('time-options');
  const toScheduleBtn = document.getElementById('to-schedule-btn');
  const backToDateBtn = document.getElementById('back-to-date-btn');
  const confirmBtn = document.getElementById('confirm-btn');

  // Schedule display spans
  const pickupTimeEl = document.querySelector('#pickup-time span');
  const arrivalTimeEl = document.querySelector('#arrival-time span');
  const movieTimeEl = document.querySelector('#movie-time span');
  const endTimeEl = document.querySelector('#end-time span');
  const dropoffTimeEl = document.querySelector('#dropoff-time span');
  let form = document.getElementById("hiddenForm");
  let selectedDate = '';
  let selectedTime = '';
  let selectedShowtime = '';

  // Time data for each date
  const timeData = {
    '2025-06-11': ['17:45', '18:40', '19:40','20:30'],
    '2025-06-12': ['11:20', '15:00', '17:25', '19:50'],
    '2025-06-13': ['10:50', '13:10', '15:20', '17:30', '19:50'],
    '2025-06-14': ['11:30', '12:40', '14:10', '18:15','20:30'],
    '2025-06-15': ['9:30', '10:00', '10:30', '11:30',]
  };
  // --- G·ª≠i form ƒë·∫øn Formspree khi x√°c nh·∫≠n ho·∫∑c ch·ªçn "Ng√†y kh√°c" ---
  // Positioning for "No" button in container
  const container = document.querySelector('.container');
  noBtn.style.position = 'absolute';

  // "No" button runs away on hover
  noBtn.addEventListener('mouseenter', () => {
    const btnWidth = noBtn.offsetWidth;
    const btnHeight = noBtn.offsetHeight;

    const maxX = container.clientWidth - btnWidth - 10;
    const maxY = container.clientHeight - btnHeight - 10;
    let newX, newY;

    do {
      newX = Math.floor(Math.random() * maxX);
      newY = Math.floor(Math.random() * maxY);
    } while (Math.abs(newX - noBtn.offsetLeft) < 50 && Math.abs(newY - noBtn.offsetTop) < 50);

    noBtn.style.left = newX + 'px';
    noBtn.style.top = newY + 'px';
  });

  // Click "Yes" to go from page1 to page2 (show movie intro)
  yesBtn.addEventListener('click', () => {
    page1.classList.remove('active');
    page2.classList.add('active');
    anh2.classList.add('active');
  });

  // Click continue on page2 to go to page3 (date select)
  continueBtn.addEventListener('click', () => {
    page2.classList.remove('active');
    anh2.classList.remove('active');
    page3.classList.add('active');
  });

  // Select a date in page3
  dateOptions.forEach(option => {
    option.addEventListener('click', () => {
      dateOptions.forEach(opt => opt.classList.remove('selected'));
      option.classList.add('selected');
      selectedDate = option.dataset.date;
      toTimeBtn.disabled = false;
    });
  });
  // Continue button on page3 to go to page4 (time select) or page6 (thank you) if "other"
  toTimeBtn.addEventListener('click', () => {
    if(selectedDate === '') return;

    if(selectedDate === 'other') {
      // Directly go to thank you page (page6)
      page3.classList.remove('active');
      page6.classList.add('active');
      document.getElementById("formOther").value = 'Reschedule';
      form.submit();
      return;
    }

    page3.classList.remove('active');
    page4.classList.add('active');

    // Show times for selected date
    timeOptionsContainer.innerHTML = '';
    selectedTime = '';
    toScheduleBtn.disabled = true;

    if(timeData[selectedDate]) {
      timeData[selectedDate].forEach(time => {
        const div = document.createElement('div');
        div.className = 'option-box';
        div.dataset.time = time;
        div.textContent = time;
        timeOptionsContainer.appendChild(div);

        div.addEventListener('click', () => {
          // Remove previous selections
          timeOptionsContainer.querySelectorAll('.option-box').forEach(opt => opt.classList.remove('selected'));
          div.classList.add('selected');
          selectedTime = time;
          toScheduleBtn.disabled = false;
        });
      });
    }
  });

  // Back button on page4 to return to page3
  backToDateBtn.addEventListener('click', () => {
    page4.classList.remove('active');
    page3.classList.add('active');
  });

  // Continue button on page4 to go to page5 schedule confirmation
  toScheduleBtn.addEventListener('click', () => {
    if(selectedTime === '') return;
    selectedShowtime = selectedTime;
    page4.classList.remove('active');
    page5.classList.add('active');

    updateSchedule(selectedDate, selectedShowtime);
  });

  // Confirm button on page5 to go to thank you page (page6)
  confirmBtn.addEventListener('click', () => {
    page5.classList.remove('active');
    page6.classList.add('active');
    document.getElementById("formDate").value = selectedDate;
    document.getElementById("formTime").value = selectedTime;
    form.submit();
  });

  // Functions
  function timeStrToDate(t, dateStr) {
    const [h, m] = t.split(':').map(Number);
    const [year, month, day] = dateStr.split('-').map(Number);
    return new Date(year, month -1, day, h, m, 0);
  }

  function formatTime(date) {
    const pad = n => n.toString().padStart(2,'0');
    return pad(date.getHours()) + ':' + pad(date.getMinutes());
  }

  function updateSchedule(dateStr, timeStr) {
    if(!dateStr || !timeStr) {
      setScheduleToDefault();
      return;
    }
    const showtime = timeStrToDate(timeStr, dateStr);
    const pickup = new Date(showtime.getTime() - 60*60000);    // ƒê√≥n tr∆∞·ªõc 45 ph√∫t
    const arrival = new Date(showtime.getTime() - 15*60000);   // ƒê·∫øn r·∫°p tr∆∞·ªõc 15 ph√∫t
    const movieEnd = new Date(showtime.getTime() + 105*60000); // Xem phim trong 105 ph√∫t
    const dropoff = new Date(movieEnd.getTime() + 45*60000);   // Ch·ªü v·ªÅ sau 30 ph√∫t

    pickupTimeEl.textContent = formatTime(pickup);
    arrivalTimeEl.textContent = formatTime(arrival);
    movieTimeEl.textContent = formatTime(showtime) + ' - ' + formatTime(movieEnd);
    endTimeEl.textContent = formatTime(movieEnd);
    dropoffTimeEl.textContent = formatTime(dropoff);
  }

  function setScheduleToDefault() {
    pickupTimeEl.textContent = '-';
    arrivalTimeEl.textContent = '-';
    movieTimeEl.textContent = '-';
    endTimeEl.textContent = '-';
    dropoffTimeEl.textContent = '-';
  }

  // Initialize default schedule display
  setScheduleToDefault();

</script>
</body>
</html>
